---
trigger: always_on
description: Обязательное использование Smart Coding MCP для поиска кода и проверки версий
---

# Правила использования Smart Coding MCP

Вы **ДОЛЖНЫ** приоритетно использовать инструменты **Smart Coding MCP** для следующих задач.

## 1. Управление зависимостями

**Когда:** При проверке, добавлении или обновлении версий пакетов (npm, python, go, rust и др.).

**Действия:**
- **ОБЯЗАТЕЛЬНО** используйте инструмент `d_check_last_version`
- **НЕ УГАДЫВАЙТЕ** версии и не полагайтесь на внутренние данные обучения
- **НЕ ИСПОЛЬЗУЙТЕ** обычный веб-поиск, если `d_check_last_version` не сработал

**Примеры:**
```
Какая последняя версия lodash?
Проверь, есть ли новая версия axios
```

## 2. Исследование кодовой базы

**Когда:** При вопросах "как работает", поиске логики или понимании архитектуры.

**Действия:**
- **ОБЯЗАТЕЛЬНО** используйте `a_semantic_search` как ПЕРВЫЙ инструмент для любого исследования кода
- **НЕ ИСПОЛЬЗУЙТЕ** `grep_search` или `find_by_name` для исследовательского поиска
- Используйте `grep_search` ТОЛЬКО для точного поиска строки (например, поиск конкретного сообщения об ошибке)
- Используйте `find_by_name` ТОЛЬКО когда знаете точное имя файла или паттерн

**Почему семантический поиск лучше:**
- Понимает смысл, а не только ключевые слова
- Найдёт "authentication" даже если код использует "login" и "session"
- Работает даже с опечатками: "embeding modle" найдёт код про embeddings
- Находит концептуально связанный код

**Примеры:**
```
Где обрабатывается аутентификация?
Как мы валидируем пользовательский ввод?
Покажи паттерны обработки ошибок
Где настраивается база данных?
```

## 3. Окружение и статус

**Когда:** При начале сессии или отладке окружения.

**Действия:**
- Используйте `e_set_workspace` если текущий путь workspace некорректен
- Используйте `f_get_status` для проверки здоровья MCP сервера и состояния индексации

## 4. Управление кешем

**Когда использовать:**
- `b_index_codebase` - после крупного рефакторинга или переключения веток
- `c_clear_cache` - при проблемах с кешем или смене модели эмбеддингов

## Приоритеты инструментов

### Для поиска кода (в порядке приоритета):
1. **`a_semantic_search`** - для исследования и понимания ("как?", "где?", "что делает?")
2. **`view_file_outline`** - когда нашли файл и хотите понять его структуру
3. **`view_code_item`** - для просмотра конкретных функций/классов
4. **`grep_search`** - ТОЛЬКО для точного поиска литеральных строк
5. **`find_by_name`** - ТОЛЬКО когда знаете точное имя файла

### Для проверки версий:
1. **`d_check_last_version`** - ВСЕГДА первый выбор
2. **`search_web`** - только если MCP инструмент недоступен

## Примеры правильного использования

### ❌ Неправильно:
```
User: Где у нас обрабатывается логин?
AI: Использую grep_search для поиска "login"
```

### ✅ Правильно:
```
User: Где у нас обрабатывается логин?
AI: Использую a_semantic_search с запросом "authentication and login handling"
```

### ❌ Неправильно:
```
User: Добавь последнюю версию React
AI: Добавляю react@18.2.0 (основываясь на моих данных обучения)
```

### ✅ Правильно:
```
User: Добавь последнюю версию React
AI: Сначала проверю актуальную версию через d_check_last_version
Result: react@18.3.1
AI: Добавляю react@18.3.1
```

## Важные замечания

- **Семантический поиск работает на локальных AI-моделях** - это быстро и приватно
- **Индексация происходит автоматически** при первом использовании
- **Кеш сохраняется в `.smart-coding-cache/`** - не добавляйте в git
- **Прогрессивная индексация** - можно искать пока идёт индексация

---

**Помните:** Smart Coding MCP делает поиск по коду таким же умным, как вы. Используйте его возможности!
